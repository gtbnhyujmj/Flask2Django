é€™æ˜¯ä¸€å€‹å®Œæ•´çš„æ•™å­¸ï¼Œæœƒä¸€æ­¥æ­¥å¸¶ä½ æŠŠ Flask çš„å¸³è™Ÿç®¡ç†ç³»çµ±é‡æ§‹æˆ Django ç‰ˆæœ¬ï¼Œå°ˆæ¡ˆåç¨±ç‚º scï¼Œä¸¦èªªæ˜è™›æ“¬ç’°å¢ƒã€è³‡æ–™å¤¾çµæ§‹ã€è¦æ‰“é–‹å’Œç·¨è¼¯å“ªäº›æª”æ¡ˆã€‚

âœ… ç¬¬ä¸€æ­¥ï¼šå»ºç«‹è™›æ“¬ç’°å¢ƒèˆ‡å®‰è£ Django
æ‰“é–‹ Terminalï¼Œè¼¸å…¥ä»¥ä¸‹æŒ‡ä»¤ï¼š

bash
è¤‡è£½
ç·¨è¼¯
python3 -m venv venv
source venv/bin/activate  # Windows ç”¨æˆ¶è«‹æ”¹ç”¨ venv\Scripts\activate
pip install django
ç¢ºèªå®‰è£æˆåŠŸï¼š

bash
è¤‡è£½
ç·¨è¼¯
python -m django --version
âœ… ç¬¬äºŒæ­¥ï¼šå»ºç«‹ Django å°ˆæ¡ˆèˆ‡æ‡‰ç”¨ç¨‹å¼
bash
è¤‡è£½
ç·¨è¼¯
django-admin startproject sc
cd sc
python manage.py startapp accounts
çµæ§‹æœƒè®Šæˆé€™æ¨£ï¼š

è¤‡è£½
ç·¨è¼¯
sc/
â”œâ”€â”€ accounts/        â† æˆ‘å€‘ä¸»è¦çš„å¸³è™Ÿ appï¼ˆåŸ Flask åŠŸèƒ½éƒ½æ¬é€™è£¡ï¼‰
â”œâ”€â”€ sc/              â† å°ˆæ¡ˆè¨­å®šè³‡æ–™å¤¾
â”œâ”€â”€ manage.py
âœ… ç¬¬ä¸‰æ­¥ï¼šè¨­å®šè³‡æ–™åº«èˆ‡è¨»å†Š App
ç·¨è¼¯ sc/settings.pyï¼Œæ‰¾åˆ° INSTALLED_APPSï¼ŒåŠ å…¥ï¼š

python
è¤‡è£½
ç·¨è¼¯
INSTALLED_APPS = [
    ...
    'accounts',
]
åŒæ™‚ç¢ºèªè³‡æ–™åº«è¨­å®šï¼ˆé è¨­å°±æ˜¯ SQLiteï¼‰ï¼š

python
è¤‡è£½
ç·¨è¼¯
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.sqlite3',
        'NAME': BASE_DIR / 'db.sqlite3',
    }
}
âœ… ç¬¬å››æ­¥ï¼šå»ºç«‹ User æ¨¡å‹ï¼ˆåƒè€ƒ Flask çš„ Userï¼‰
æ‰“é–‹ accounts/models.pyï¼Œå…§å®¹å¦‚ä¸‹ï¼š

python
è¤‡è£½
ç·¨è¼¯
from django.db import models
from django.contrib.auth.models import AbstractUser

class User(AbstractUser):
    accountID = models.IntegerField(null=True, blank=True)
ç„¶å¾Œåœ¨ sc/settings.py æŒ‡å®šé€™å€‹æ¨¡å‹ä½œç‚ºé è¨­ Userï¼š

python
è¤‡è£½
ç·¨è¼¯
AUTH_USER_MODEL = 'accounts.User'
âœ… ç¬¬äº”æ­¥ï¼šå»ºç«‹è¡¨å–®èˆ‡è¨»å†Šé é¢
å»ºç«‹ accounts/forms.pyï¼š

python
è¤‡è£½
ç·¨è¼¯
from django import forms
from django.contrib.auth.forms import UserCreationForm
from .models import User

class RegisterForm(UserCreationForm):
    class Meta:
        model = User
        fields = ['username', 'password1', 'password2']
âœ… ç¬¬å…­æ­¥ï¼šè¨­å®š view å’Œ url
ğŸ”¹å»ºç«‹ view
æ‰“é–‹ accounts/views.pyï¼š

python
è¤‡è£½
ç·¨è¼¯
from django.shortcuts import render, redirect
from django.contrib.auth import login, authenticate, logout
from django.contrib.auth.decorators import login_required
from .forms import RegisterForm
from .models import User
from urllib.parse import parse_qs
from django.http import JsonResponse, HttpResponse

def home(request):
    return render(request, 'home.html')

def register(request):
    if request.method == 'POST':
        form = RegisterForm(request.POST)
        if form.is_valid():
            user = form.save()
            login(request, user)
            return redirect('dashboard')
    else:
        form = RegisterForm()
    return render(request, 'register.html', {'form': form})

def login_view(request):
    if request.method == 'POST':
        username = request.POST['username']
        password = request.POST['password']
        user = authenticate(request, username=username, password=password)
        if user:
            login(request, user)
            return redirect('dashboard')
        else:
            return render(request, 'login.html', {'error': 'å¸³è™Ÿæˆ–å¯†ç¢¼éŒ¯èª¤'})
    return render(request, 'login.html')

@login_required
def dashboard(request):
    return render(request, 'dashboard.html', {'username': request.user.username})

@login_required
def api_users(request):
    users = User.objects.all().values('id', 'username', 'password')
    return JsonResponse(list(users), safe=False)

def json_view(request):
    if request.method == "POST":
        raw_data = request.body.decode("utf-8")
    else:
        raw_data = request.META.get('QUERY_STRING', '')

    parsed_qs = parse_qs(raw_data)
    parsed_dict = {k: v[0] if len(v) == 1 else v for k, v in parsed_qs.items()}

    return render(request, 'json_view.html', {
        'raw_data': raw_data,
        'parsed_dict': parsed_dict
    })
ğŸ”¹è¨­å®š URL
æ‰“é–‹ accounts/urls.pyï¼ˆè‡ªå·±æ–°å¢é€™å€‹æª”æ¡ˆï¼‰ï¼š

python
è¤‡è£½
ç·¨è¼¯
from django.urls import path
from . import views

urlpatterns = [
    path('', views.home, name='home'),
    path('register/', views.register, name='register'),
    path('login/', views.login_view, name='login'),
    path('dashboard/', views.dashboard, name='dashboard'),
    path('json_view/', views.json_view, name='json_view'),
    path('api/users/', views.api_users, name='api_users'),
]
ç„¶å¾Œåœ¨ sc/urls.py ä¸­åŠ å…¥ï¼š

python
è¤‡è£½
ç·¨è¼¯
from django.contrib import admin
from django.urls import path, include

urlpatterns = [
    path('admin/', admin.site.urls),
    path('', include('accounts.urls')),
]
âœ… ç¬¬ä¸ƒæ­¥ï¼šå»ºç«‹ template èˆ‡å•Ÿå‹•æœå‹™
åœ¨ accounts/ åº•ä¸‹å»ºç«‹è³‡æ–™å¤¾ templates/ å’Œä»¥ä¸‹ HTML æª”æ¡ˆï¼š

arduino
è¤‡è£½
ç·¨è¼¯
accounts/templates/
â”œâ”€â”€ home.html
â”œâ”€â”€ login.html
â”œâ”€â”€ register.html
â”œâ”€â”€ dashboard.html
â”œâ”€â”€ json_view.html
ç„¶å¾Œåœ¨ settings.py è¨­å®š templates ç›®éŒ„ï¼ˆDjango æœƒè‡ªå‹•æ‰¾åˆ° app è£¡çš„ templatesï¼‰

å•Ÿå‹•è³‡æ–™åº«ï¼š

bash
è¤‡è£½
ç·¨è¼¯
python manage.py makemigrations
python manage.py migrate
å•Ÿå‹•ä¼ºæœå™¨ï¼š

bash
è¤‡è£½
ç·¨è¼¯
python manage.py runserver
âœ… æœ€å¾Œï¼šç®¡ç†è€…å¸³è™Ÿèˆ‡ admin
bash
è¤‡è£½
ç·¨è¼¯
python manage.py createsuperuser
å¯ä»¥ç”¨ /admin/ é€²å…¥å¾Œå°æŸ¥çœ‹ User è³‡æ–™è¡¨ã€‚

âœ… åŠ åˆ†åŠŸèƒ½ï¼šæ–°å¢æ¬„ä½ accountID
ä½ å·²ç¶“åœ¨æ¨¡å‹è£¡é¢åŠ äº† accountIDï¼Œåªè¦é‡æ–°é·ç§»ä¸€æ¬¡ï¼š

bash
è¤‡è£½
ç·¨è¼¯
python manage.py makemigrations accounts
python manage.py migrate
å¦‚æœä½ éœ€è¦æˆ‘å¹«ä½ è£œé½Š templates/*.html è£¡çš„å…§å®¹ã€CSSã€API æ•´åˆç¯„ä¾‹ï¼Œæˆ‘å¯ä»¥æ¥çºŒå¹«ä½ å¯«ä¸‹å»ã€‚è¦å—ï¼Ÿ







ä½ èªªï¼š
